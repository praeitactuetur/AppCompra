<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lista de la Compra</title>
    <style>
        /* Ajustes de diseño */
        body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background-color: #f4f4f9; }
        #app { width: 90%; max-width: 400px; background-color: rgba(255, 255, 255, 0.9); padding: 15px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); text-align: center; }
        input, select, button { width: 100%; padding: 10px; font-size: 1em; margin-top: 10px; border: none; border-radius: 5px; }
        #addButton { background-color: #28a745; color: white; }
        #addButton:hover { background-color: #218838; }
        ul { list-style-type: none; padding: 0; margin-top: 15px; max-height: 50vh; overflow-y: auto; }
        li { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #ddd; margin-top: 5px; }
        .bought { text-decoration: line-through; color: grey; }
        .button { padding: 8px; font-size: 0.9em; cursor: pointer; border: none; border-radius: 5px; }
        .toggle { background-color: #ffc107; color: white; }
        .toggle:hover { background-color: #e0a800; }
        .delete { background-color: #dc3545; color: white; }
        .delete:hover { background-color: #c82333; }
    </style>
    <!-- Firebase App -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
</head>
<body>
    <div id="app">
        <h2>Lista de la Compra</h2>
        <input type="text" id="itemInput" placeholder="Añadir artículo...">
        <input type="number" id="quantityInput" placeholder="Cantidad" min="1" value="1">
        <select id="categoryInput">
            <option value="General">General</option>
            <option value="Frutas y Verduras">Frutas y Verduras</option>
            <option value="Lácteos">Lácteos</option>
            <option value="Carnes">Carnes</option>
            <option value="Panadería">Panadería</option>
        </select>
        <button id="addButton">Añadir a la lista</button>
        <ul id="shoppingList"></ul>
    </div>

    <script>
        // Configuración de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAr-t7HI2o9Ty-Bj4lprXOp0RVRQaMW3qg",
            authDomain: "lista-de-la-compra-6fbd5.firebaseapp.com",
            databaseURL: "https://lista-de-la-compra-6fbd5-default-rtdb.firebaseio.com",
            projectId: "lista-de-la-compra-6fbd5",
            storageBucket: "lista-de-la-compra-6fbd5.appspot.com",
            messagingSenderId: "427885773780",
            appId: "1:427885773780:web:fe080ad539f1d735854c41",
            measurementId: "G-BGYH085F18"
        };
        
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref("shoppingList");

        // Agregar artículo con categoría y cantidad
        document.getElementById("addButton").addEventListener("click", () => {
            const itemInput = document.getElementById("itemInput");
            const quantityInput = document.getElementById("quantityInput");
            const categoryInput = document.getElementById("categoryInput");
            const itemName = itemInput.value.trim();
            const quantity = quantityInput.value || 1;
            const category = categoryInput.value;

            if (itemName) {
                db.push({ name: itemName, quantity: quantity, category: category, bought: false });
                itemInput.value = "";
                quantityInput.value = 1;
                categoryInput.value = "General";
            }
        });

        // Renderizar lista en tiempo real
        db.on("value", (snapshot) => {
            const shoppingList = document.getElementById("shoppingList");
            shoppingList.innerHTML = "";  // Limpiar lista antes de renderizar
            snapshot.forEach((childSnapshot) => {
                const item = childSnapshot.val();
                const itemId = childSnapshot.key;

                const li = document.createElement("li");
                li.className = item.bought ? "bought" : "";

                // Mostrar nombre, cantidad y categoría
                const itemText = document.createElement("span");
                itemText.textContent = `${item.name} - ${item.quantity} (${item.category})`;
                li.appendChild(itemText);

                // Botones de marcar y eliminar
                const buttons = document.createElement("div");

                const toggleButton = document.createElement("button");
                toggleButton.className = "button toggle";
                toggleButton.textContent = item.bought ? "Desmarcar" : "Comprado";
                toggleButton.addEventListener("click", () => {
                    db.child(itemId).update({ bought: !item.bought });
                });
                buttons.appendChild(toggleButton);

                const deleteButton = document.createElement("button");
                deleteButton.className = "button delete";
                deleteButton.textContent = "Eliminar";
                deleteButton.addEventListener("click", () => {
                    db.child(itemId).remove();
                });
                buttons.appendChild(deleteButton);

                li.appendChild(buttons);
                shoppingList.appendChild(li);
            });
        });
    </script>
</body>
</html>
