<script>
    // Configuración de Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyAr-t7HI2o9Ty-Bj4lprXOp0RVRQaMW3qg",
        authDomain: "lista-de-la-compra-6fbd5.firebaseapp.com",
        databaseURL: "https://lista-de-la-compra-6fbd5-default-rtdb.firebaseio.com",
        projectId: "lista-de-la-compra-6fbd5",
        storageBucket: "lista-de-la-compra-6fbd5.appspot.com",
        messagingSenderId: "427885773780",
        appId: "1:427885773780:web:fe080ad539f1d735854c41",
        measurementId: "G-BGYH085F18"
    };

    // Inicializar Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database().ref("shoppingList");

    // Función para agregar artículo
    const addItem = () => {
        const itemInput = document.getElementById("itemInput");
        const itemName = itemInput.value.trim();
        if (itemName) {
            db.push({ name: itemName, bought: false });
            itemInput.value = "";
        }
    };

    document.getElementById("addButton").addEventListener("click", addItem);

    // Permitir agregar artículos con "Enter"
    document.getElementById("itemInput").addEventListener("keydown", (event) => {
        if (event.key === "Enter") {
            addItem();
        }
    });

    // Integrar API de Reconocimiento de Voz
    const voiceButton = document.getElementById("voiceButton");
    const itemInput = document.getElementById("itemInput");

    // Verificar si el navegador soporta la API de reconocimiento de voz
    if ('webkitSpeechRecognition' in window) {
        const recognition = new webkitSpeechRecognition();
        recognition.lang = 'es-ES';  // Idioma español
        recognition.interimResults = false;

        // Evento cuando se detecta un resultado de voz
        recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript;
            itemInput.value = transcript;
        };

        // Manejo de errores de reconocimiento de voz
        recognition.onerror = (event) => {
            console.error("Error en el reconocimiento de voz:", event.error);
        };

        // Iniciar reconocimiento de voz al hacer clic en el botón de micrófono
        voiceButton.addEventListener("click", () => {
            recognition.start();
        });
    } else {
        // Si el navegador no soporta la API, deshabilitamos el botón de voz
        voiceButton.disabled = true;
        voiceButton.title = "Tu navegador no soporta el reconocimiento de voz.";
    }

    // Renderizar lista en tiempo real
    db.on("value", (snapshot) => {
        const shoppingList = document.getElementById("shoppingList");
        shoppingList.innerHTML = "";  // Limpiar lista antes de renderizar
        snapshot.forEach((childSnapshot) => {
            const item = childSnapshot.val();
            const itemId = childSnapshot.key;

            const li = document.createElement("li");
            li.className = item.bought ? "bought" : "";

            // Mostrar nombre del artículo
            const itemText = document.createElement("span");
            itemText.textContent = item.name;
            li.appendChild(itemText);

            // Botones de marcar y eliminar
            const buttons = document.createElement("div");

            const toggleButton = document.createElement("button");
            toggleButton.className = "button toggle";
            toggleButton.textContent = item.bought ? "Desmarcar" : "Comprado";
            toggleButton.addEventListener("click", () => {
                db.child(itemId).update({ bought: !item.bought });
            });
            buttons.appendChild(toggleButton);

            const deleteButton = document.createElement("button");
            deleteButton.className = "button delete";
            deleteButton.textContent = "Eliminar";
            deleteButton.addEventListener("click", () => {
                db.child(itemId).remove();
            });
            buttons.appendChild(deleteButton);

            li.appendChild(buttons);
            shoppingList.appendChild(li);
        });
    });
</script>


